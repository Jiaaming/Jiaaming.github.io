<!doctype html><html lang=en-gb><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=content-type content="text/html"><meta name=viewport content="width=device-width,initial-scale=1"><title itemprop=name>Building a Simple AI Conversational Assistant with Langchain.js | James Liu's Space</title>
<meta property="og:title" content="Building a Simple AI Conversational Assistant with Langchain.js | James Liu's Space"><meta name=twitter:title content="Building a Simple AI Conversational Assistant with Langchain.js | James Liu's Space"><meta itemprop=name content="Building a Simple AI Conversational Assistant with Langchain.js | James Liu's Space"><meta name=application-name content="Building a Simple AI Conversational Assistant with Langchain.js | James Liu's Space"><meta property="og:site_name" content="James Liu's Space"><meta name=description content="Hi, I'm James Liu, a software engineer. This is my personal blog."><meta itemprop=description content="Hi, I'm James Liu, a software engineer. This is my personal blog."><meta property="og:description" content="Hi, I'm James Liu, a software engineer. This is my personal blog."><meta name=twitter:description content="Hi, I'm James Liu, a software engineer. This is my personal blog."><meta property="og:locale" content="en-gb"><meta name=language content="en-gb"><link rel=alternate hreflang=en-gb href=http://localhost:1313/posts/tech-pet-sys/ title=English><meta property="og:type" content="article"><meta property="og:article:published_time" content=2024-04-22T00:00:00Z><meta property="article:published_time" content=2024-04-22T00:00:00Z><meta property="og:url" content="http://localhost:1313/posts/tech-pet-sys/"><meta property="og:article:author" content="James Liu"><meta property="article:author" content="James Liu"><meta name=author content="James Liu"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Building a Simple AI Conversational Assistant with Langchain.js","author":{"@type":"Person","name":""},"datePublished":"2024-04-22","description":"","wordCount":1039,"mainEntityOfPage":"True","dateModified":"2024-04-22","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"James Liu\u0027s Space"}}</script><meta name=generator content="Hugo 0.143.1"><meta property="og:url" content="http://localhost:1313/posts/tech-pet-sys/"><meta property="og:site_name" content="James Liu's Space"><meta property="og:title" content="Building a Simple AI Conversational Assistant with Langchain.js"><meta property="og:description" content="For my final undergraduate professional course, Software Development Practicum, I was tasked with developing a virtual veterinary hospital learning system that required implementing an AI conversational assistant. The requirements were somewhat ambiguous. Considering that the other components consisted mainly of basic CRUD operations, my initial approach was to explore integrating these operations with an AI dialogue system capable of querying information about medications and clinical cases stored in the database."><meta property="og:locale" content="en_gb"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-22T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-22T00:00:00+00:00"><meta property="article:tag" content="Tech"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building a Simple AI Conversational Assistant with Langchain.js"><meta name=twitter:description content="For my final undergraduate professional course, Software Development Practicum, I was tasked with developing a virtual veterinary hospital learning system that required implementing an AI conversational assistant. The requirements were somewhat ambiguous. Considering that the other components consisted mainly of basic CRUD operations, my initial approach was to explore integrating these operations with an AI dialogue system capable of querying information about medications and clinical cases stored in the database."><link rel=canonical href=http://localhost:1313/posts/tech-pet-sys/><link href=/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css rel=stylesheet><link href=/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icons/favicon-16x16.png><link rel=mask-icon href=/icons/safari-pinned-tab.svg><link rel="shortcut icon" href=/favicon.ico><link rel=manifest href=http://localhost:1313/site.webmanifest><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#2d89ef"><meta name=theme-color content="#434648"><link rel=icon type=image/svg+xml href=/icons/favicon.svg></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-M5PNJCCWD3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M5PNJCCWD3")</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "e287a9b48dcd4649878c9dbb732790c0"}'></script><body data-theme=dark class=notransition><script src=/js/theme.js></script><div class=navbar role=navigation><nav class=menu aria-label="Main Navigation"><a href=http://localhost:1313/ class=logo><svg width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><title>Home</title><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
</a><input type=checkbox id=menu-trigger class=menu-trigger>
<label for=menu-trigger><span class=menu-icon><svg width="25" height="25" stroke="currentcolor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7H3.40726"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M.5 12.5V1.5c0-.552285.447715-1 1-1h11C13.0523.5 13.5.947715 13.5 1.5v11C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C.947715 13.5.5 13.0523.5 12.5z"/></svg></span></label><div class=trigger><ul class=trigger-container><li><a class=menu-link href=/>Home</a></li><li><a class="menu-link active" href=/posts/>Posts</a></li><li><a class=menu-link href=/pages/about/>About</a></li><li><a class=menu-link href=/cv.pdf>CV</a></li><li><a class=menu-link href=https://cogitovault.jamesliu.space/#/page/1>BlogðŸ˜¶</a></li><li class=menu-separator><span>|</span></li></ul><a id=mode href=#><svg class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg><svg class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg></a></div></nav></div><div class="wrapper post"><main class=page-content aria-label=Content><article><header class=header><h1 class=header-title>Building a Simple AI Conversational Assistant with Langchain.js</h1><div class=post-meta><time datetime=2024-04-22T00:00:00+00:00 itemprop=datePublished>22 Apr 2024</time></div></header><details class=toc zgotmplz><summary><b>Table of Contents</b></summary><nav id=TableOfContents><ul><li><ul><li><a href=#what-is-rag-from-gpt-4>What is RAG? (from GPT-4)</a><ul><li><a href=#how-rag-works>How RAG Works</a></li><li><a href=#advantages-of-rag>Advantages of RAG</a></li><li><a href=#application-scenarios>Application Scenarios</a></li><li><a href=#technical-challenges>Technical Challenges</a></li></ul></li><li><a href=#implementation-details>Implementation Details</a></li><li><a href=#results>Results:</a></li></ul></li></ul></nav></details><div class=page-content><p>For my final undergraduate professional course, Software Development Practicum, I was tasked with developing a virtual veterinary hospital learning system that required implementing an AI conversational assistant. The requirements were somewhat ambiguous. Considering that the other components consisted mainly of basic CRUD operations, my initial approach was to explore integrating these operations with an AI dialogue system capable of querying information about medications and clinical cases stored in the database.</p><p>The architecture I adopted was a Retrieval-Augmented Generation (RAG) framework. Following the principle of simplicity, I implemented the solution using Langchain.js entirely on the frontend, utilizing OpenAI&rsquo;s API for language processing and Pinecone&rsquo;s remote vector database service.</p><p><img src=/images/cp11/IMG_0591688ACE75-1.jpeg alt="Architecture Diagram"></p><h2 id=what-is-rag-from-gpt-4>What is RAG? (from GPT-4)</h2><p>Retrieval-Augmented Generation (RAG) is a technique that combines information retrieval with generative models to enhance the quality and relevance of natural language processing tasks. It leverages external knowledge sources (such as document databases or information repositories) to augment the capabilities of generative models, making it particularly effective for question answering, summarization, translation, and similar tasks.</p><h3 id=how-rag-works>How RAG Works</h3><p>A RAG model consists of two main components: <strong>retriever</strong> and <strong>generator</strong>.</p><ol><li><strong>Retriever</strong>:</li></ol><ul><li>The retriever&rsquo;s task is to identify and extract the most relevant documents or information fragments from a large collection of documents in response to an input query. This is typically implemented through vector similarity search, where both queries and documents are encoded as vectors, and similarity metrics are used to find the best matches.</li></ul><ol start=2><li><strong>Generator</strong>:</li></ol><ul><li>The generator is typically a Transformer-based language model, such as GPT or BERT. It uses the retrieved documents as contextual information to generate answers. This allows the generated content to rely not only on the model&rsquo;s internal knowledge (learned during training) but also on external, specific information directly relevant to the current query.</li></ul><h3 id=advantages-of-rag>Advantages of RAG</h3><ul><li><strong>Enhanced Information Richness</strong>: Compared to traditional generative models, RAG increases the amount of information available for processing queries by accessing external databases.</li><li><strong>Improved Accuracy and Relevance</strong>: For tasks that depend on external knowledge, RAG can provide more accurate and detailed answers.</li><li><strong>Flexibility</strong>: The ability to access any form of structured or unstructured data sources as needed.</li></ul><h3 id=application-scenarios>Application Scenarios</h3><p>RAG models are highly effective in various applications, including:</p><ul><li><strong>Question Answering Systems</strong>: Capable of generating detailed answers, especially when fact-checking through external information sources is required.</li><li><strong>Content Summarization</strong>: Extracting key information from related documents to generate concise summaries.</li><li><strong>Article Writing</strong>: Referencing and integrating various resources and reports when creating content, enhancing richness and depth.</li></ul><h3 id=technical-challenges>Technical Challenges</h3><p>Despite its numerous advantages, implementing RAG technology presents several challenges:</p><ul><li><strong>Retrieval Efficiency</strong>: Efficient retrieval of relevant documents is critical for real-time applications, requiring optimization of indexing and query processing.</li><li><strong>Data Synchronization</strong>: Ensuring that the external knowledge base is up-to-date is crucial for guaranteeing the accuracy and relevance of generated content.</li><li><strong>Result Consistency</strong>: Generated content must maintain consistency with retrieved documents to avoid producing misleading or incorrect information.</li></ul><h2 id=implementation-details>Implementation Details</h2><p>First, I registered for an account on the Pinecone website (steps omitted).</p><p><img src=/images/cp11/Screenshot_2024-04-22_at_16.17.52.png alt="Pinecone Dashboard"></p><p>In Pinecone, a single project can contain multiple indices, and each index can be divided into multiple namespaces. Since I was using the free tier, which limits users to one project and one index, I differentiated between different sections using namespaces.</p><p>For instance, this project involves queries for medications (medicine) and laboratory tests (lab), so I defined these two namespaces accordingly. Namespaces are specified as parameters during insertion and don&rsquo;t require manual setup. When querying, you can search within specific namespaces, which is quite convenient.</p><p>For each record, the namespace and ID are immutable, but you can update the Values and metadata (the Key-Value pairs shown below) based on the ID.</p><p>For the Values, these are arrays converted during the embedding process. I used OpenAI&rsquo;s text-embedding-ada-002 model on the frontend, which produces 1536-dimensional vectors, hence the length of 1536.</p><p><img src=/images/cp11/Screenshot_2024-04-22_at_16.23.02.png alt="Pinecone Record Structure"></p><pre tabindex=0><code>export const pineconeAdd = async (id, namespace, input_text, metadata) =&gt; {
    const embedding = await embedText(input_text);
    try {
        const insertResponse = await index.namespace(namespace).upsert([
            {
                id: `${namespace}${id}`,
                values: embedding,
                metadata: metadata
            }
        ]);
        return { success: true, message: &#39;Pinecone insertion successful&#39;, detail: insertResponse };
    } catch (error) {
        return { success: false, message: &#39;Pinecone insertion error&#39;, error };
    }
};
</code></pre><p>The logic for the frontend insertion part is executed simultaneously with the insertion into MySQL. The update process is similar:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tsx data-lang=tsx><span class=line><span class=cl><span class=c1>// Insert data into Pinecone
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=nx>newMedicine</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>saveToPinecone</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>input_text</span> <span class=o>=</span> <span class=s2>&#34;Medicine Name: &#34;</span> <span class=o>+</span> <span class=nx>newMedicine</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>medicine_name</span> <span class=o>+</span> <span class=s2>&#34;, Medicine Cost: &#34;</span><span class=o>+</span> <span class=nx>newMedicine</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>medicine_cost</span><span class=p>.</span><span class=nx>toString</span><span class=p>()</span> <span class=o>+</span> <span class=s2>&#34;, Efficacy and Usage: &#34;</span> <span class=o>+</span> <span class=nx>newMedicine</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>description</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>insert_pinecone</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>pineconeAdd</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>medicine_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=sb>`medicine`</span><span class=p>,</span> <span class=nx>input_text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>medicine_name</span>: <span class=kt>newMedicine.value.medicine_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>medicine_cost</span>: <span class=kt>newMedicine.value.medicine_cost</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>description</span>: <span class=kt>newMedicine.value.description</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>insert_pinecone</span><span class=o>?</span><span class=p>.</span><span class=nx>success</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nx>ElMessage</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Pinecone insertion successful&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>type</span><span class=o>:</span> <span class=s1>&#39;success&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>ElMessage</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`Pinecone insertion failed: </span><span class=si>${</span><span class=nx>insert_pinecone</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Logic for handling the AI page:</p><pre tabindex=0><code>if (queryType.value === &#39;medicine&#39;) {

    const queryResponse = await pineconeIndex.namespace(&#39;medicine&#39;).query({
      topK: 5,
      vector: await embedText(userInput.value),
      includeMetadata: true,
    })
    console.log(&#34;Query Response:&#34;, queryResponse);
    responseText.value = &#34;Querying...&#34;;
    if (queryResponse?.data?.length === 0) {
      responseText.value = &#34;No relevant information found&#34;;
      return;
    }

    const formattedData = medicineFormatForLLM(queryResponse);
    console.log(&#34;Formatted Data for LLM:&#34;, formattedData);

    const llmQuery = getMedicineLLMQuery(formattedData, userInput.value);
    console.log(&#34;LLM Query:&#34;, llmQuery);
    responseText.value = llmQuery;

    console.log(userInput.value);

    const response = await chat.invoke([
      new HumanMessage(
          llmQuery
      ),
    ]);
    console.log(response);
    responseText.value = response.content as string;
  }
</code></pre><p>Utility functions and the delete function used:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>medicineFormatForLLM</span> <span class=o>=</span> <span class=p>(</span><span class=nx>queryResponse</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>queryResponse</span><span class=p>.</span><span class=nx>matches</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>match</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>id</span><span class=o>:</span> <span class=nx>match</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>name</span><span class=o>:</span> <span class=nx>match</span><span class=p>.</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>medicine_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>cost</span><span class=o>:</span> <span class=nx>match</span><span class=p>.</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>medicine_cost</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>description</span><span class=o>:</span> <span class=nx>match</span><span class=p>.</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>description</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>score</span><span class=o>:</span> <span class=nx>match</span><span class=p>.</span><span class=nx>score</span>
</span></span><span class=line><span class=cl>    <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>getMedicineLLMQuery</span> <span class=o>=</span> <span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>userInput</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Convert data to text format for use as query context
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>context</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>item</span> <span class=p>=&gt;</span> <span class=sb>`ID: </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>, Medicine Name: </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>, 
</span></span></span><span class=line><span class=cl><span class=sb>    Medicine Cost (in RMB): </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>cost</span><span class=si>}</span><span class=sb>, Description: </span><span class=si>${</span><span class=nx>item</span><span class=p>.</span><span class=nx>description</span><span class=si>}</span><span class=sb>`</span><span class=p>).</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sb>`Based on the following retrieved medicine information:</span><span class=err>\</span><span class=sb>n</span><span class=si>${</span><span class=nx>context</span><span class=si>}</span><span class=err>\</span><span class=sb>nAnswer the user&#39;s question in Chinese:</span><span class=err>\</span><span class=sb>n</span><span class=si>${</span><span class=nx>userInput</span><span class=si>}</span><span class=sb>.`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>pineconeDelete</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>id</span><span class=p>,</span> <span class=nx>namespace</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>ns</span> <span class=o>=</span> <span class=nx>index</span><span class=p>.</span><span class=nx>namespace</span><span class=p>(</span><span class=s1>&#39;medicine&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=nx>ns</span><span class=p>.</span><span class=nx>deleteOne</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>namespace</span><span class=si>}${</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Text retrieval involves first vectorizing the user&rsquo;s query, then comparing it with the values using cosine similarity, extracting the top K most similar texts, and generating a response by combining the texts with the user&rsquo;s query and a custom prompt.</p><h2 id=results>Results:</h2><p><img src=/images/cp11//Untitled.png alt=Untitled></p><p><img src=/images/cp11//Untitled1.png alt=Untitled></p><p><img src=/images/cp11//Untitled2.png alt=Untitled></p><p>Finally, a note on Langchain: the JavaScript version and documentation are quite lacking. When I used the Python version for my thesis, I used a vectorStore, but following the documentation for the JavaScript version, it was completely unusable. In the end, I only used some basic functions, which seemed almost unnecessary.</p></div></article></main></div><footer class=footer><span class=footer_item></span>&nbsp;<div class=footer_social-icons><a href=https://github.com/jiaaming target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://www.linkedin.com/in/liu-jiaming/ target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=https://x.com/james_1iu target=_blank rel="noopener noreferrer me" title=X><svg viewBox="0 0 1200 1227" fill="currentcolor"><path d="M714.163 519.284 1160.89.0H1055.03L667.137 450.887 357.328.0H0L468.492 681.821.0 1226.37H105.866L515.491 750.218 842.672 1226.37H12e2L714.137 519.284H714.163zM569.165 687.828l-47.468-67.894L144.011 79.6944H306.615L611.412 515.685l47.468 67.894 396.2 566.721H892.476L569.165 687.854V687.828z"/></svg>
</a><a href=https://www.youtube.com/@JamesLiu2002 target=_blank rel="noopener noreferrer me" title=Youtube><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78.0 00-1.94-2C18.88 4 12 4 12 4s-6.88.0-8.6.46a2.78 2.78.0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78.0 003.4 19c1.72.46 8.6.46 8.6.46s6.88.0 8.6-.46a2.78 2.78.0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z"/><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/></svg>
</a><a href=https://space.bilibili.com/70573422 target=_blank rel="noopener noreferrer me" title=Bilibili><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round"><rect x="1.3333" y="6" width="21.333" height="15.333" rx="4" ry="4"/><path d="m8 12.4v1.2"/><path d="m16 12.4v1.2"/><path d="m5.8853 2.6667L8.552 5.3334"/><path d="m18.115 2.6667-2.6667 2.6667"/></svg></a></div><small class=footer_copyright>Â© 2025 James Liu.
Powered by <a href=https://github.com/hugo-sid/hugo-blog-awesome target=_blank rel=noopener>Hugo blog awesome</a>.</small></footer><a href=# title="Go to top" id=totop><svg width="48" height="48" fill="currentcolor" stroke="currentcolor" viewBox="0 96 960 960"><path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197z"/></svg>
</a><script async src=http://localhost:1313/js/main.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "e287a9b48dcd4649878c9dbb732790c0"}'></script></body></html>